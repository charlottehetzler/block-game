(this["webpackJsonpblock-game"]=this["webpackJsonpblock-game"]||[]).push([[0],{10:function(e,t,n){e.exports={options:"Options_options__1_QKv",off:"Options_off__2ANuc",on:"Options_on__259wj",disabled:"Options_disabled__tWZ0b"}},15:function(e,t,n){e.exports={manual:"Manual_manual__1qvu4"}},22:function(e,t,n){"use strict";n.r(t);var i,o,c,s,a=n(2),r=n.n(a),d=n(13),l=n.n(d),p=n(6),h=n.n(p),u=n(8),j=n(5),f=n(14),b=n(7),x=n.n(b),O=n(4),w=n(3),v=[],m=[],g=!1,y=0;function _(e){var t=e.x,n=e.z,i=e.width,o=e.depth,c=e.direction,s=k({x:t,y:1*v.length,z:n,width:i,depth:o,falls:!1});s.direction=c,v.push(s)}function k(e){var t=e.x,n=e.y,i=e.z,s=e.width,a=e.depth,r=e.falls,d=new w.b(s,1,a),l=new w.c("hsl(".concat(30+4*v.length,", 100%, 50%)")),p=new w.f({color:l}),h=new w.e(d,p);h.position.set(t,n,i),o.add(h);var u=new O.Box(new O.Vec3(s/2,.5,a/2)),j=r?5:0,f=new O.Body({mass:j,shape:u});f.position.set(t,n,i),c.addBody(f);return{threejs:h,cannonjs:f,width:s,depth:a,direction:"x"}}function S(){var e=.15;y=v.length-1;var t=v[v.length-1];t.threejs.position[t.direction]+=e,t.cannonjs.position[t.direction]+=e,function(){var e=document.querySelector("#count");e&&(e.innerHTML=y.toString())}(),i.position.y<1*(v.length-2)+4&&(i.position.y+=e),c.step(1/60),m.forEach((function(e){e.threejs.position.copy(e.cannonjs.position),e.threejs.quaternion.copy(e.cannonjs.quaternion)})),s.render(o,i)}function z(){if(g){var e=v[v.length-1],t=v[v.length-2],n=e.direction,i=e.threejs.position[n]-t.threejs.position[n],o=Math.abs(i),c="x"==n?e.width:e.depth,a=c-o;if(a>0){var r=function(e){var t=e.topLayer,n=e.overlap,i=e.size,o=e.delta,c=t.direction,s="x"==c?n:t.width,a="z"==c?n:t.depth;t.width=s,t.depth=a,t.threejs.scale[c]=n/i,t.threejs.position[c]-=o/2,t.cannonjs.position[c]-=o/2;var r=new O.Box(new O.Vec3(s/2,.5,a/2));return t.cannonjs.shapes=[],t.cannonjs.addShape(r),{newWidth:s,newDepth:a}}({topLayer:e,overlap:a,size:c,delta:i}),d=r.newWidth,l=r.newDepth,p=(a/2+o/2)*Math.sign(i);!function(e){var t=e.x,n=e.z,i=e.width,o=e.depth,c=k({x:t,y:1*(v.length-1),z:n,width:i,depth:o,falls:!0});m.push(c)}({x:"x"==n?e.threejs.position.x+p:e.threejs.position.x,z:"z"==n?e.threejs.position.z+p:e.threejs.position.z,width:"x"==n?o:d,depth:"z"==n?o:l}),_({x:"x"==n?e.threejs.position.x:-10,z:"z"==n?e.threejs.position.z:-10,width:d,depth:l,direction:"x"==n?"z":"x"})}else!function(){s.setAnimationLoop(null),window.removeEventListener("click",(function(){return z()}));var e=document.querySelector("#gm-count");e&&(e.innerHTML=y.toString());var t=document.getElementById("gameOverScreen");t&&t.style&&(t.style.display="flex")}()}else s.setAnimationLoop(S),g=!0}var E=function(){(c=new O.World).gravity.set(0,-10,0),c.broadphase=new O.NaiveBroadphase,c.solver.iterations=40,o=new w.h,_({x:0,z:0,width:3,depth:3,direction:""}),_({x:-10,z:0,width:3,depth:3,direction:"x"});var e=new w.a(16777215,.6);o.add(e);var t=new w.d(16777215,.6);t.position.set(10,20,0),o.add(t),(i=function(){var e=10+window.innerHeight/window.innerWidth;return new w.g(-5,5,e/2,e/-2,1,100)}()).position.set(4,4,4),i.lookAt(0,0,0),(s=new w.i({antialias:!0,alpha:!0})).setSize(window.innerWidth,window.innerHeight),s.render(o,i);var n=document.getElementById("root");n&&n.appendChild(s.domElement),window.addEventListener("click",(function(){return z()})),window.addEventListener("keyup",(function(e){switch(e.code){case"Space":case"Enter":z();break;default:console.log(e.code)}}))},N=n(15),L=n.n(N),A=n(0),B=function(){return Object(A.jsxs)("div",{className:L.a.manual,children:[Object(A.jsxs)("p",{children:[Object(A.jsx)("kbd",{children:Object(A.jsx)("i",{className:"fas fa-mouse"})}),", ",Object(A.jsx)("kbd",{children:"Space"})," or ",Object(A.jsx)("kbd",{children:"Enter"})," to place a block"]}),Object(A.jsxs)("p",{children:[Object(A.jsx)("kbd",{children:"R"})," to try again or reload the page"]})]})},q=n(1),I=n(12),W=n(10),C=n.n(W),M=function(e){var t=e.options,n=e.setOptions,i=Object(a.useState)(t),o=Object(j.a)(i,2),c=o[0],s=o[1];function r(e){s(Object(I.a)(Object(I.a)({},c),{},Object(q.a)({},e,!c[e])))}return Object(a.useEffect)((function(){n(c)}),[c]),Object(a.useEffect)((function(){s(t)}),[t]),Object(A.jsxs)("div",{className:C.a.options,children:[Object(A.jsx)("h2",{children:"Settings"}),Object.keys(c).map((function(e){return Object(A.jsxs)("p",{children:[Object(A.jsxs)("b",{children:[e,":"]})," ",c[e]?Object(A.jsx)("p",{className:C.a.on,onClick:function(t){return r(e)},children:Object(A.jsx)("i",{className:"far fa-check-square"})}):Object(A.jsx)("p",{className:C.a.off,onClick:function(t){return r(e)},children:Object(A.jsx)("i",{className:"far fa-square"})})]})}))]})},J=function(){var e="little-block-game.options",t=Object(a.useState)({dev:!1,manual:!1}),n=Object(j.a)(t,2),i=n[0],o=n[1];function c(){window.location.reload()}function s(){var t,n=(t=e,null===localStorage.getItem(t)?(localStorage.setItem(t,JSON.stringify({})),{}):JSON.parse(localStorage.getItem(t)||"{}"));return n=={}?i:n}return Object(a.useEffect)((function(){(function(){var e=Object(u.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o(s());case 2:E();case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[]),Object(a.useEffect)((function(){!function(){t=e,n=i,localStorage.setItem(t,JSON.stringify(n));var t,n}()}),[i]),window.addEventListener("keyup",(function(e){"KeyR"==e.code&&c()})),Object(A.jsxs)(A.Fragment,{children:[i.dev?Object(A.jsx)("div",{id:x.a.dev,children:Object(A.jsx)(f.a,{})}):null,Object(A.jsxs)("div",{id:x.a.app,children:[Object(A.jsx)("div",{id:"count",className:x.a.count,children:"0"}),Object(A.jsxs)("div",{id:"gameOverScreen",className:x.a.gameOver,children:[Object(A.jsx)("h1",{children:"Game Over!"}),Object(A.jsxs)("h2",{children:["You reached ",Object(A.jsx)("span",{id:"gm-count",children:"0"})," Points!"]}),Object(A.jsx)("button",{onClick:function(e){return c()},children:"Try again!"}),Object(A.jsx)(M,{options:i,setOptions:o})]})]}),i.manual?Object(A.jsx)("div",{id:x.a.manual,children:Object(A.jsx)(B,{})}):null]})};l.a.render(Object(A.jsx)(r.a.StrictMode,{children:Object(A.jsx)(J,{})}),document.getElementById("root"))},7:function(e,t,n){e.exports={root:"App_root__2CSG3",app:"App_app__2ziFi",count:"App_count__32WNx",gameOver:"App_gameOver__3iCsK"}}},[[22,1,2]]]);
//# sourceMappingURL=main.8260ed7b.chunk.js.map