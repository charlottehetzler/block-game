(this["webpackJsonpblock-game"]=this["webpackJsonpblock-game"]||[]).push([[0],{10:function(e,n,t){e.exports={options:"Options_options__1_QKv",off:"Options_off__2ANuc",on:"Options_on__259wj",disabled:"Options_disabled__tWZ0b"}},15:function(e,n,t){e.exports={manual:"Manual_manual__1qvu4"}},22:function(e,n,t){"use strict";t.r(n);var i,o,s,a,c=t(2),r=t.n(c),d=t(13),l=t.n(d),p=t(5),h=t.n(p),u=t(7),j=t(8),f=t(14),x=t(6),b=t.n(x),w=t(4),O=t(3),v=[],m=[],g=!1,y=0;function _(e){var n=e.x,t=e.z,i=e.width,o=e.depth,s=e.direction,a=k({x:n,y:1*v.length,z:t,width:i,depth:o,falls:!1});a.direction=s,v.push(a)}function k(e){var n=e.x,t=e.y,i=e.z,a=e.width,c=e.depth,r=e.falls,d=new O.b(a,1,c),l=new O.c("hsl(".concat(30+4*v.length,", 100%, 50%)")),p=new O.f({color:l}),h=new O.e(d,p);h.position.set(n,t,i),o.add(h);var u=new w.Box(new w.Vec3(a/2,.5,c/2)),j=r?5:0,f=new w.Body({mass:j,shape:u});f.position.set(n,t,i),s.addBody(f);return{threejs:h,cannonjs:f,width:a,depth:c,direction:"x"}}function z(){var e=.15;y=v.length-1;var n=v[v.length-1];n.threejs.position[n.direction]+=e,n.cannonjs.position[n.direction]+=e,function(){var e=document.querySelector("#count");e&&(e.innerHTML=y.toString())}(),i.position.y<1*(v.length-2)+4&&(i.position.y+=e),s.step(1/60),m.forEach((function(e){e.threejs.position.copy(e.cannonjs.position),e.threejs.quaternion.copy(e.cannonjs.quaternion)})),a.render(o,i)}function S(){if(g){var e=v[v.length-1],n=v[v.length-2],t=e.direction,i=e.threejs.position[t]-n.threejs.position[t],o=Math.abs(i),s="x"==t?e.width:e.depth,c=s-o;if(c>0){var r=function(e){var n=e.topLayer,t=e.overlap,i=e.size,o=e.delta,s=n.direction,a="x"==s?t:n.width,c="z"==s?t:n.depth;n.width=a,n.depth=c,n.threejs.scale[s]=t/i,n.threejs.position[s]-=o/2,n.cannonjs.position[s]-=o/2;var r=new w.Box(new w.Vec3(a/2,.5,c/2));return n.cannonjs.shapes=[],n.cannonjs.addShape(r),{newWidth:a,newDepth:c}}({topLayer:e,overlap:c,size:s,delta:i}),d=r.newWidth,l=r.newDepth,p=(c/2+o/2)*Math.sign(i);!function(e){var n=e.x,t=e.z,i=e.width,o=e.depth,s=k({x:n,y:1*(v.length-1),z:t,width:i,depth:o,falls:!0});m.push(s)}({x:"x"==t?e.threejs.position.x+p:e.threejs.position.x,z:"z"==t?e.threejs.position.z+p:e.threejs.position.z,width:"x"==t?o:d,depth:"z"==t?o:l}),_({x:"x"==t?e.threejs.position.x:-10,z:"z"==t?e.threejs.position.z:-10,width:d,depth:l,direction:"x"==t?"z":"x"})}else!function(){a.setAnimationLoop(null),window.removeEventListener("click",(function(){return S()}));var e=document.querySelector("#gm-count");e&&(e.innerHTML=y.toString());var n=document.getElementById("gameOverScreen");n&&n.style&&(n.style.display="flex")}()}else a.setAnimationLoop(z),g=!0}var N=function(){(s=new w.World).gravity.set(0,-10,0),s.broadphase=new w.NaiveBroadphase,s.solver.iterations=40,o=new O.h,_({x:0,z:0,width:3,depth:3,direction:""}),_({x:-10,z:0,width:3,depth:3,direction:"x"});var e=new O.a(16777215,.6);o.add(e);var n=new O.d(16777215,.6);n.position.set(10,20,0),o.add(n),(i=function(){var e=10+window.innerHeight/window.innerWidth;return new O.g(-5,5,e/2,e/-2,1,100)}()).position.set(4,4,4),i.lookAt(0,0,0),(a=new O.i({antialias:!0,alpha:!0})).setSize(window.innerWidth,window.innerHeight),a.render(o,i);var t=document.getElementById("root");t&&t.appendChild(a.domElement),window.addEventListener("click",(function(){return S()})),window.addEventListener("keyup",(function(e){switch(e.code){case"Space":case"Enter":S();break;default:console.log(e.code)}}))},E=t(15),L=t.n(E),A=t(0),B=function(){return Object(A.jsxs)("div",{className:L.a.manual,children:[Object(A.jsxs)("p",{children:[Object(A.jsx)("kbd",{children:Object(A.jsx)("i",{className:"fas fa-mouse"})}),", ",Object(A.jsx)("kbd",{children:"Space"})," or ",Object(A.jsx)("kbd",{children:"Enter"})," to place a block"]}),Object(A.jsxs)("p",{children:[Object(A.jsx)("kbd",{children:"R"})," to try again or reload the page"]})]})},q=t(1),I=t(12),W=t(10),C=t.n(W),M=function(e){var n=e.options,t=e.setOptions;function i(e){t(Object(I.a)(Object(I.a)({},n),{},Object(q.a)({},e,!n[e])))}return Object(A.jsxs)("div",{className:C.a.options,children:[Object(A.jsx)("h2",{children:"Settings"}),Object.keys(n).map((function(e){return Object(A.jsxs)("p",{children:[Object(A.jsxs)("b",{children:[e,":"]})," ",n[e]?Object(A.jsx)("span",{className:C.a.on,onClick:function(n){return i(e)},children:Object(A.jsx)("i",{className:"far fa-check-square"})}):Object(A.jsx)("span",{className:C.a.off,onClick:function(n){return i(e)},children:Object(A.jsx)("i",{className:"far fa-square"})})]},e)}))]})},J=function(){var e="little-block-game.options",n=Object(c.useState)({dev:!1,manual:!1}),t=Object(j.a)(n,2),i=t[0],o=t[1];function s(){window.location.reload()}function a(){var n,t;n=e,t=i,localStorage.setItem(n,JSON.stringify(t))}function r(){var n,t=(n=e,null===localStorage.getItem(n)?(localStorage.setItem(n,JSON.stringify({})),{failed:!0}):JSON.parse(localStorage.getItem(n)||"{}"));return t.failed?(a(),i):t}return Object(c.useEffect)((function(){(function(){var e=Object(u.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o(r());case 2:N();case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[]),Object(c.useEffect)((function(){a()}),[i]),window.addEventListener("keyup",(function(e){"KeyR"==e.code&&s()})),Object(A.jsxs)(A.Fragment,{children:[i.dev?Object(A.jsx)("div",{id:b.a.dev,children:Object(A.jsx)(f.a,{})}):null,Object(A.jsxs)("div",{id:b.a.app,children:[Object(A.jsx)("div",{id:"count",className:b.a.count,children:"0"}),Object(A.jsxs)("div",{id:"gameOverScreen",className:b.a.gameOver,children:[Object(A.jsx)("h1",{children:"Game Over!"}),Object(A.jsxs)("h2",{children:["You reached ",Object(A.jsx)("span",{id:"gm-count",children:"0"})," Points!"]}),Object(A.jsx)("button",{onClick:function(e){return s()},children:"Try again!"}),Object(A.jsx)(M,{options:i,setOptions:o})]})]}),i.manual?Object(A.jsx)("div",{id:b.a.manual,children:Object(A.jsx)(B,{})}):null]})};l.a.render(Object(A.jsx)(r.a.StrictMode,{children:Object(A.jsx)(J,{})}),document.getElementById("root"))},6:function(e,n,t){e.exports={root:"App_root__2CSG3",app:"App_app__2ziFi",count:"App_count__32WNx",gameOver:"App_gameOver__3iCsK"}}},[[22,1,2]]]);
//# sourceMappingURL=main.24e4d78e.chunk.js.map